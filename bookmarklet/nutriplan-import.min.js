javascript: (function () { const e = `<div id="nutriplan-config-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 999999; display: flex; justify-content: center; align-items: center;"><div style="background: white; padding: 20px; border-radius: 5px; width: 400px; max-width: 90%;"><h2 style="color: #3c803c; margin-top: 0;">NutriPlan Settings</h2><p style="margin-bottom: 15px;">Please enter your NutriPlan API token and application URL:</p><div style="margin-bottom: 15px;"><label style="display: block; margin-bottom: 5px; font-weight: bold;">API Token:</label><input type="password" id="nutriplan-api-token" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;" placeholder="Enter your API token"></div><div style="margin-bottom: 15px;"><label style="display: block; margin-bottom: 5px; font-weight: bold;">Application URL:</label><input type="url" id="nutriplan-app-url" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;" placeholder="e.g., https://nutriplan.example.com"></div><div style="display: flex; justify-content: space-between;"><button id="nutriplan-save-config" style="background-color: #4CAF50; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer;">Save Settings</button><button id="nutriplan-cancel-config" style="background-color: #f44336; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer;">Cancel</button></div><div id="nutriplan-status" style="margin-top: 15px; padding: 10px; border-radius: 4px; display: none;"></div></div></div>`, t = `<div id="nutriplan-notification-modal" style="position: fixed; top: 20px; right: 20px; background: white; padding: 15px; border-radius: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 999999; max-width: 300px; display: none;"><div id="nutriplan-notification-content"></div></div>`; const o = () => { const e = localStorage.getItem("nutriplan-api-token"), t = localStorage.getItem("nutriplan-app-url"); return { apiToken: e, appUrl: t } }, n = (e, t) => { localStorage.setItem("nutriplan-api-token", e), localStorage.setItem("nutriplan-app-url", t) }; let a = (a, l = !1) => { let i = document.getElementById("nutriplan-notification-modal"), r = document.getElementById("nutriplan-notification-content"); i || (document.body.insertAdjacentHTML("beforeend", t), i = document.getElementById("nutriplan-notification-modal"), r = document.getElementById("nutriplan-notification-content")), r.textContent = a, i.style.backgroundColor = l ? "#f2dede" : "#dff0d8", r.style.color = l ? "#a94442" : "#3c763d", i.style.display = "block", setTimeout(() => { i.style.display = "none" }, 3e3) }; const l = () => { const t = document.getElementById("nutriplan-config-modal"); t && t.remove(), document.body.insertAdjacentHTML("beforeend", e); const { apiToken: a, appUrl: l } = o(); a && (document.getElementById("nutriplan-api-token").value = a), l && (document.getElementById("nutriplan-app-url").value = l), document.getElementById("nutriplan-save-config").addEventListener("click", () => { const e = document.getElementById("nutriplan-api-token").value.trim(), t = document.getElementById("nutriplan-app-url").value.trim(); if (!e) { const e = document.getElementById("nutriplan-status"); return e.textContent = "Please enter your API token.", e.style.backgroundColor = "#f2dede", e.style.color = "#a94442", void (e.style.display = "block") } if (!t) { const e = document.getElementById("nutriplan-status"); return e.textContent = "Please enter your NutriPlan application URL.", e.style.backgroundColor = "#f2dede", e.style.color = "#a94442", void (e.style.display = "block") } try { new URL(t) } catch (e) { const o = document.getElementById("nutriplan-status"); return o.textContent = "Please enter a valid URL including http:// or https://.", o.style.backgroundColor = "#f2dede", o.style.color = "#a94442", void (o.style.display = "block") } n(e, t), document.getElementById("nutriplan-config-modal").remove(), a("Settings saved successfully!") }), document.getElementById("nutriplan-cancel-config").addEventListener("click", () => { document.getElementById("nutriplan-config-modal").remove() }) }; const i = (e, t, o) => { const n = `${o.replace(/\/$/, "")}/api/recipes/import-via-extension`; a("Sending recipe to NutriPlan..."), fetch(n, { method: "POST", headers: { "Content-Type": "application/json", Accept: "application/json", Authorization: `Bearer ${t}` }, body: JSON.stringify({ url: e }) }).then(e => { return e.ok ? void a("Recipe import started! Check your NutriPlan app shortly.") : 401 === e.status ? void a("Authentication Error: Invalid API token. Please check your settings.", !0) : 422 === e.status ? void a("Validation Error: The URL provided could not be processed.", !0) : e.status >= 500 ? void a("Server Error: There was an error processing your request.", !0) : void a(`Error: Unexpected error (${e.status}).`, !0) }).catch(e => { a("Connection Error: Could not connect to NutriPlan.", !0), console.error("Error sending URL to API:", e) }) }; (() => { const { apiToken: e, appUrl: t } = o(); e && t ? i(window.location.href, e, t) : l() })() })() 